!function(a){a.fn.jcarousel=function(b){if("string"==typeof b){var d=a(this).data("jcarousel"),e=Array.prototype.slice.call(arguments,1);return d[b].apply(d,e)}return this.each(function(){a(this).data("jcarousel",new c(this,b))})};var b={vertical:!1,start:1,offset:1,size:null,scroll:3,visible:null,animation:"normal",easing:"swing",auto:0,wrap:null,initCallback:null,reloadCallback:null,itemLoadCallback:null,itemFirstInCallback:null,itemFirstOutCallback:null,itemLastInCallback:null,itemLastOutCallback:null,itemVisibleInCallback:null,itemVisibleOutCallback:null,buttonNextHTML:"<div></div>",buttonPrevHTML:"<div></div>",buttonNextEvent:"click",buttonPrevEvent:"click",buttonNextCallback:null,buttonPrevCallback:null};a.jcarousel=function(c,d){this.options=a.extend({},b,d||{}),this.locked=!1,this.container=null,this.clip=null,this.list=null,this.buttonNext=null,this.buttonPrev=null,this.wh=this.options.vertical?"height":"width",this.lt=this.options.vertical?"top":"left";for(var e="",f=c.className.split(" "),g=0;g<f.length;g++)if(-1!=f[g].indexOf("jcarousel-skin")){a(c).removeClass(f[g]),e=f[g];break}"UL"==c.nodeName||"OL"==c.nodeName?(this.list=a(c),this.container=this.list.parent(),this.container.hasClass("jcarousel-clip")?(this.container.parent().hasClass("jcarousel-container")||(this.container=this.container.wrap("<div></div>")),this.container=this.container.parent()):this.container.hasClass("jcarousel-container")||(this.container=this.list.wrap("<div></div>").parent())):(this.container=a(c),this.list=this.container.find("ul,ol").eq(0)),""!=e&&-1==this.container.parent()[0].className.indexOf("jcarousel-skin")&&this.container.wrap('<div class=" '+e+'"></div>'),this.clip=this.list.parent(),this.clip.length&&this.clip.hasClass("jcarousel-clip")||(this.clip=this.list.wrap("<div></div>").parent()),this.buttonNext=a(".jcarousel-next",this.container),0==this.buttonNext.size()&&null!=this.options.buttonNextHTML&&(this.buttonNext=this.clip.after(this.options.buttonNextHTML).next()),this.buttonNext.addClass(this.className("jcarousel-next")),this.buttonPrev=a(".jcarousel-prev",this.container),0==this.buttonPrev.size()&&null!=this.options.buttonPrevHTML&&(this.buttonPrev=this.clip.after(this.options.buttonPrevHTML).next()),this.buttonPrev.addClass(this.className("jcarousel-prev")),this.clip.addClass(this.className("jcarousel-clip")).css({overflow:"hidden",position:"relative"}),this.list.addClass(this.className("jcarousel-list")).css({overflow:"hidden",position:"relative",top:0,left:0,margin:0,padding:0}),this.container.addClass(this.className("jcarousel-container")).css({position:"relative"});var h=null!=this.options.visible?Math.ceil(this.clipping()/this.options.visible):null,i=this.list.children("li"),j=this;if(i.size()>0){var k=0,g=this.options.offset;i.each(function(){j.format(this,g++),k+=j.dimension(this,h)}),this.list.css(this.wh,k+"px"),d&&void 0!==d.size||(this.options.size=i.size())}this.container.css("display","block"),this.buttonNext.css("display","block"),this.buttonPrev.css("display","block"),this.funcNext=function(){j.next()},this.funcPrev=function(){j.prev()},this.funcResize=function(){j.reload()},null!=this.options.initCallback&&this.options.initCallback(this,"init"),a.browser.safari?(this.buttons(!1,!1),a(window).bind("load.jcarousel",function(){j.setup()})):this.setup()};var c=a.jcarousel;c.fn=c.prototype={jcarousel:"0.2.4"},c.fn.extend=c.extend=a.extend,c.fn.extend({setup:function(){if(this.first=null,this.last=null,this.prevFirst=null,this.prevLast=null,this.animating=!1,this.timer=null,this.tail=null,this.inTail=!1,!this.locked){this.list.css(this.lt,this.pos(this.options.offset)+"px");var b=this.pos(this.options.start);this.prevFirst=this.prevLast=null,this.animate(b,!1),a(window).unbind("resize.jcarousel",this.funcResize).bind("resize.jcarousel",this.funcResize)}},reset:function(){this.list.empty(),this.list.css(this.lt,"0px"),this.list.css(this.wh,"10px"),null!=this.options.initCallback&&this.options.initCallback(this,"reset"),this.setup()},reload:function(){if(null!=this.tail&&this.inTail&&this.list.css(this.lt,c.intval(this.list.css(this.lt))+this.tail),this.tail=null,this.inTail=!1,null!=this.options.reloadCallback&&this.options.reloadCallback(this),null!=this.options.visible){var b=this,d=Math.ceil(this.clipping()/this.options.visible),e=0,f=0;a("li",this.list).each(function(a){e+=b.dimension(this,d),a+1<b.first&&(f=e)}),this.list.css(this.wh,e+"px"),this.list.css(this.lt,-f+"px")}this.scroll(this.first,!1)},lock:function(){this.locked=!0,this.buttons()},unlock:function(){this.locked=!1,this.buttons()},size:function(a){return void 0!=a&&(this.options.size=a,this.locked||this.buttons()),this.options.size},has:function(a,b){void 0!=b&&b||(b=a),null!==this.options.size&&b>this.options.size&&(b=this.options.size);for(var c=a;c<=b;c++){var d=this.get(c);if(!d.length||d.hasClass("jcarousel-item-placeholder"))return!1}return!0},get:function(b){return a(".jcarousel-item-"+b,this.list)},add:function(a,b){var d=this.get(a),e=0;if(0==d.length){for(var g,d=this.create(a),h=c.intval(a);g=this.get(--h);)if(h<=0||g.length){h<=0?this.list.prepend(d):g.after(d);break}}else e=this.dimension(d);d.removeClass(this.className("jcarousel-item-placeholder")),"string"==typeof b?d.html(b):d.empty().append(b);var i=null!=this.options.visible?Math.ceil(this.clipping()/this.options.visible):null,j=this.dimension(d,i)-e;return a>0&&a<this.first&&this.list.css(this.lt,c.intval(this.list.css(this.lt))-j+"px"),this.list.css(this.wh,c.intval(this.list.css(this.wh))+j+"px"),d},remove:function(a){var b=this.get(a);if(b.length&&!(a>=this.first&&a<=this.last)){var d=this.dimension(b);a<this.first&&this.list.css(this.lt,c.intval(this.list.css(this.lt))+d+"px"),b.remove(),this.list.css(this.wh,c.intval(this.list.css(this.wh))-d+"px")}},next:function(){this.stopAuto(),null==this.tail||this.inTail?this.scroll("both"!=this.options.wrap&&"last"!=this.options.wrap||null==this.options.size||this.last!=this.options.size?this.first+this.options.scroll:1):this.scrollTail(!1)},prev:function(){this.stopAuto(),null!=this.tail&&this.inTail?this.scrollTail(!0):this.scroll("both"!=this.options.wrap&&"first"!=this.options.wrap||null==this.options.size||1!=this.first?this.first-this.options.scroll:this.options.size)},scrollTail:function(a){if(!this.locked&&!this.animating&&this.tail){var b=c.intval(this.list.css(this.lt));a?b+=this.tail:b-=this.tail,this.inTail=!a,this.prevFirst=this.first,this.prevLast=this.last,this.animate(b)}},scroll:function(a,b){this.locked||this.animating||this.animate(this.pos(a),b)},pos:function(a){var b=c.intval(this.list.css(this.lt));if(this.locked||this.animating)return b;"circular"!=this.options.wrap&&(a=a<1?1:this.options.size&&a>this.options.size?this.options.size:a);for(var l,d=this.first>a,e="circular"!=this.options.wrap&&this.first<=1?1:this.first,f=this.get(d?e:this.last),g=d?e:e-1,h=null,i=0,j=!1,k=0;d?--g>=a:++g<a;)h=this.get(g),j=!h.length,0==h.length&&(h=this.create(g).addClass(this.className("jcarousel-item-placeholder")),f[d?"before":"after"](h),null!=this.first&&"circular"==this.options.wrap&&null!==this.options.size&&(g<=0||g>this.options.size)&&(l=this.get(this.index(g)),l.length&&this.add(g,l.children().clone(!0)))),f=h,k=this.dimension(h),j&&(i+=k),null!=this.first&&("circular"==this.options.wrap||g>=1&&(null==this.options.size||g<=this.options.size))&&(b=d?b+k:b-k);for(var m=this.clipping(),n=[],o=0,g=a,p=0,f=this.get(a-1);++o;){h=this.get(g),j=!h.length,0==h.length&&(h=this.create(g).addClass(this.className("jcarousel-item-placeholder")),0==f.length?this.list.prepend(h):f[d?"before":"after"](h),null!=this.first&&"circular"==this.options.wrap&&null!==this.options.size&&(g<=0||g>this.options.size)&&(l=this.get(this.index(g)),l.length&&this.add(g,l.find(">*").clone(!0)))),f=h;var k=this.dimension(h);if(0==k)return alert("jCarousel: No width/height set for items. This will cause an infinite loop. Aborting..."),0;if("circular"!=this.options.wrap&&null!==this.options.size&&g>this.options.size?n.push(h):j&&(i+=k),p+=k,p>=m)break;g++}for(var q=0;q<n.length;q++)n[q].remove();i>0&&(this.list.css(this.wh,this.dimension(this.list)+i+"px"),d&&(b-=i,this.list.css(this.lt,c.intval(this.list.css(this.lt))-i+"px")));var r=a+o-1;if("circular"!=this.options.wrap&&this.options.size&&r>this.options.size&&(r=this.options.size),g>r)for(o=0,g=r,p=0;++o;){var h=this.get(g--);if(!h.length)break;if(p+=this.dimension(h),p>=m)break}var s=r-o+1;if("circular"!=this.options.wrap&&s<1&&(s=1),this.inTail&&d&&(b+=this.tail,this.inTail=!1),this.tail=null,"circular"!=this.options.wrap&&r==this.options.size&&r-o+1>=1){var t=c.margin(this.get(r),this.options.vertical?"marginBottom":"marginRight");p-t>m&&(this.tail=p-m-t)}for(;a-->s;)b+=this.dimension(this.get(a));return this.prevFirst=this.first,this.prevLast=this.last,this.first=s,this.last=r,b},animate:function(a,b){if(!this.locked&&!this.animating){this.animating=!0;var c=this,d=function(){c.animating=!1,0==a&&c.list.css(c.lt,0),("circular"==c.options.wrap||"both"==c.options.wrap||"last"==c.options.wrap||null==c.options.size||c.last<c.options.size)&&c.startAuto(),c.buttons(),c.notify("onAfterAnimation")};if(this.notify("onBeforeAnimation"),this.options.animation&&0!=b){var e=this.options.vertical?{top:a}:{left:a};this.list.animate(e,this.options.animation,this.options.easing,d)}else this.list.css(this.lt,a+"px"),d()}},startAuto:function(a){if(void 0!=a&&(this.options.auto=a),0==this.options.auto)return this.stopAuto();if(null==this.timer){var b=this;this.timer=setTimeout(function(){b.next()},1e3*this.options.auto)}},stopAuto:function(){null!=this.timer&&(clearTimeout(this.timer),this.timer=null)},buttons:function(a,b){if(void 0==a||null==a){var a=!this.locked&&0!==this.options.size&&(this.options.wrap&&"first"!=this.options.wrap||null==this.options.size||this.last<this.options.size);this.locked||this.options.wrap&&"first"!=this.options.wrap||null==this.options.size||!(this.last>=this.options.size)||(a=null!=this.tail&&!this.inTail)}if(void 0==b||null==b){var b=!this.locked&&0!==this.options.size&&(this.options.wrap&&"last"!=this.options.wrap||this.first>1);this.locked||this.options.wrap&&"last"!=this.options.wrap||null==this.options.size||1!=this.first||(b=null!=this.tail&&this.inTail)}var c=this;this.buttonNext[a?"bind":"unbind"](this.options.buttonNextEvent+".jcarousel",this.funcNext)[a?"removeClass":"addClass"](this.className("jcarousel-next-disabled")).attr("disabled",a?!1:!0),this.buttonPrev[b?"bind":"unbind"](this.options.buttonPrevEvent+".jcarousel",this.funcPrev)[b?"removeClass":"addClass"](this.className("jcarousel-prev-disabled")).attr("disabled",b?!1:!0),this.buttonNext.length>0&&(void 0==this.buttonNext[0].jcarouselstate||this.buttonNext[0].jcarouselstate!=a)&&null!=this.options.buttonNextCallback&&(this.buttonNext.each(function(){c.options.buttonNextCallback(c,this,a)}),this.buttonNext[0].jcarouselstate=a),this.buttonPrev.length>0&&(void 0==this.buttonPrev[0].jcarouselstate||this.buttonPrev[0].jcarouselstate!=b)&&null!=this.options.buttonPrevCallback&&(this.buttonPrev.each(function(){c.options.buttonPrevCallback(c,this,b)}),this.buttonPrev[0].jcarouselstate=b)},notify:function(a){var b=null==this.prevFirst?"init":this.prevFirst<this.first?"next":"prev";this.callback("itemLoadCallback",a,b),this.prevFirst!==this.first&&(this.callback("itemFirstInCallback",a,b,this.first),this.callback("itemFirstOutCallback",a,b,this.prevFirst)),this.prevLast!==this.last&&(this.callback("itemLastInCallback",a,b,this.last),this.callback("itemLastOutCallback",a,b,this.prevLast)),this.callback("itemVisibleInCallback",a,b,this.first,this.last,this.prevFirst,this.prevLast),this.callback("itemVisibleOutCallback",a,b,this.prevFirst,this.prevLast,this.first,this.last)},callback:function(b,c,d,e,f,g,h){if(void 0!=this.options[b]&&("object"==typeof this.options[b]||"onAfterAnimation"==c)){var i="object"==typeof this.options[b]?this.options[b][c]:this.options[b];if(a.isFunction(i)){var j=this;if(void 0===e)i(j,d,c);else if(void 0===f)this.get(e).each(function(){i(j,this,e,d,c)});else for(var k=e;k<=f;k++)null===k||k>=g&&k<=h||this.get(k).each(function(){i(j,this,k,d,c)})}}},create:function(a){return this.format("<li></li>",a)},format:function(b,c){var d=a(b).addClass(this.className("jcarousel-item")).addClass(this.className("jcarousel-item-"+c)).css({"float":"left","list-style":"none"});return d.attr("jcarouselindex",c),d},className:function(a){return a+" "+a+(this.options.vertical?"-vertical":"-horizontal")},dimension:function(b,d){var e=void 0!=b.jquery?b[0]:b,f=this.options.vertical?e.offsetHeight+c.margin(e,"marginTop")+c.margin(e,"marginBottom"):e.offsetWidth+c.margin(e,"marginLeft")+c.margin(e,"marginRight");if(void 0==d||f==d)return f;var g=this.options.vertical?d-c.margin(e,"marginTop")-c.margin(e,"marginBottom"):d-c.margin(e,"marginLeft")-c.margin(e,"marginRight");return a(e).css(this.wh,g+"px"),this.dimension(e)},clipping:function(){return this.options.vertical?this.clip[0].offsetHeight-c.intval(this.clip.css("borderTopWidth"))-c.intval(this.clip.css("borderBottomWidth")):this.clip[0].offsetWidth-c.intval(this.clip.css("borderLeftWidth"))-c.intval(this.clip.css("borderRightWidth"))},index:function(a,b){return void 0==b&&(b=this.options.size),Math.round(((a-1)/b-Math.floor((a-1)/b))*b)+1}}),c.extend({defaults:function(c){return a.extend(b,c||{})},margin:function(b,d){if(!b)return 0;var e=void 0!=b.jquery?b[0]:b;if("marginRight"==d&&a.browser.safari){var g,h,f={display:"block","float":"none",width:"auto"};return a.swap(e,f,function(){g=e.offsetWidth}),f.marginRight=0,a.swap(e,f,function(){h=e.offsetWidth}),h-g}return c.intval(a.css(e,d))},intval:function(a){return a=parseInt(a),isNaN(a)?0:a}})}(jQuery);
